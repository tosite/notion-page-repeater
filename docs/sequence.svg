<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="690px" preserveAspectRatio="none" style="width:1413px;height:690px;background:#FFFFFF;" version="1.1" viewBox="0 0 1413 690" width="1413px" zoomAndPan="magnify"><defs><filter height="300%" id="fbqo29148n5zg" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="193" x="608.25" y="28.708">Notion-page-repeater</text><rect fill="#FFFFFF" filter="url(#fbqo29148n5zg)" height="352.9922" style="stroke:#000000;stroke-width:2.0;" width="1251.5" x="148" y="207.7813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="29" x2="29" y1="102.25" y2="622.0391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="235" x2="235" y1="102.25" y2="622.0391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="806.5" x2="806.5" y1="102.25" y2="622.0391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="904.5" x2="904.5" y1="102.25" y2="622.0391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1014.5" x2="1014.5" y1="102.25" y2="622.0391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1141.5" x2="1141.5" y1="102.25" y2="622.0391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1267.5" x2="1267.5" y1="102.25" y2="622.0391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1362.5" x2="1362.5" y1="102.25" y2="622.0391"/><rect fill="#FEFECE" filter="url(#fbqo29148n5zg)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="45" x="5" y="66.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="12" y="86.9482">cron</text><rect fill="#FEFECE" filter="url(#fbqo29148n5zg)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="45" x="5" y="621.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="12" y="641.0342">cron</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="158" y="98.9482">Notion-page-repeater</text><ellipse cx="235.5" cy="69.9531" fill="#FEFECE" filter="url(#fbqo29148n5zg)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="231.5,57.9531,237.5,52.9531,235.5,57.9531,237.5,62.9531,231.5,57.9531" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="158" y="634.0342">Notion-page-repeater</text><ellipse cx="235.5" cy="653.3359" fill="#FEFECE" filter="url(#fbqo29148n5zg)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="231.5,641.3359,237.5,636.3359,235.5,641.3359,237.5,646.3359,231.5,641.3359" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="761.5" y="98.9482">SettingPage</text><path d="M788.5,49.9531 C788.5,39.9531 806.5,39.9531 806.5,39.9531 C806.5,39.9531 824.5,39.9531 824.5,49.9531 L824.5,75.9531 C824.5,85.9531 806.5,85.9531 806.5,85.9531 C806.5,85.9531 788.5,85.9531 788.5,75.9531 L788.5,49.9531 " fill="#FEFECE" filter="url(#fbqo29148n5zg)" style="stroke:#000000;stroke-width:1.5;"/><path d="M788.5,49.9531 C788.5,59.9531 806.5,59.9531 806.5,59.9531 C806.5,59.9531 824.5,59.9531 824.5,49.9531 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="761.5" y="634.0342">SettingPage</text><path d="M788.5,647.3359 C788.5,637.3359 806.5,637.3359 806.5,637.3359 C806.5,637.3359 824.5,637.3359 824.5,647.3359 L824.5,673.3359 C824.5,683.3359 806.5,683.3359 806.5,683.3359 C806.5,683.3359 788.5,683.3359 788.5,673.3359 L788.5,647.3359 " fill="#FEFECE" filter="url(#fbqo29148n5zg)" style="stroke:#000000;stroke-width:1.5;"/><path d="M788.5,647.3359 C788.5,657.3359 806.5,657.3359 806.5,657.3359 C806.5,657.3359 824.5,657.3359 824.5,647.3359 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="861.5" y="98.9482">ParentPage</text><path d="M886.5,49.9531 C886.5,39.9531 904.5,39.9531 904.5,39.9531 C904.5,39.9531 922.5,39.9531 922.5,49.9531 L922.5,75.9531 C922.5,85.9531 904.5,85.9531 904.5,85.9531 C904.5,85.9531 886.5,85.9531 886.5,75.9531 L886.5,49.9531 " fill="#FEFECE" filter="url(#fbqo29148n5zg)" style="stroke:#000000;stroke-width:1.5;"/><path d="M886.5,49.9531 C886.5,59.9531 904.5,59.9531 904.5,59.9531 C904.5,59.9531 922.5,59.9531 922.5,49.9531 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="861.5" y="634.0342">ParentPage</text><path d="M886.5,647.3359 C886.5,637.3359 904.5,637.3359 904.5,637.3359 C904.5,637.3359 922.5,637.3359 922.5,647.3359 L922.5,673.3359 C922.5,683.3359 904.5,683.3359 904.5,683.3359 C904.5,683.3359 886.5,683.3359 886.5,673.3359 L886.5,647.3359 " fill="#FEFECE" filter="url(#fbqo29148n5zg)" style="stroke:#000000;stroke-width:1.5;"/><path d="M886.5,647.3359 C886.5,657.3359 904.5,657.3359 904.5,657.3359 C904.5,657.3359 922.5,657.3359 922.5,647.3359 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#fbqo29148n5zg)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="111" x="957.5" y="50.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="964.5" y="70.6514">ParentPage-&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="974.5" y="86.9482">LatestPage</text><rect fill="#FEFECE" filter="url(#fbqo29148n5zg)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="111" x="957.5" y="621.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="964.5" y="641.0342">ParentPage-&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="974.5" y="657.3311">LatestPage</text><rect fill="#FEFECE" filter="url(#fbqo29148n5zg)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="114" x="1082.5" y="50.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1091" y="70.6514">ParentPage-&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="1089.5" y="86.9482">TemplatePage</text><rect fill="#FEFECE" filter="url(#fbqo29148n5zg)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="114" x="1082.5" y="621.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1091" y="641.0342">ParentPage-&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="1089.5" y="657.3311">TemplatePage</text><rect fill="#FEFECE" filter="url(#fbqo29148n5zg)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="111" x="1210.5" y="50.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1217.5" y="70.6514">ParentPage-&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="1233.5" y="86.9482">NewPage</text><rect fill="#FEFECE" filter="url(#fbqo29148n5zg)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="111" x="1210.5" y="621.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1217.5" y="641.0342">ParentPage-&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="1233.5" y="657.3311">NewPage</text><rect fill="#FEFECE" filter="url(#fbqo29148n5zg)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="50" x="1335.5" y="66.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="1342.5" y="86.9482">Slack</text><rect fill="#FEFECE" filter="url(#fbqo29148n5zg)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="50" x="1335.5" y="621.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="1342.5" y="641.0342">Slack</text><polygon fill="#A80036" points="223.5,144.5156,233.5,148.5156,223.5,152.5156,227.5,148.5156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="29.5" x2="229.5" y1="148.5156" y2="148.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="36.5" y="128.3169">Run the script periodically.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="36.5" y="143.4497">定期的にスクリプトを実行する</text><polygon fill="#A80036" points="794.5,188.7813,804.5,192.7813,794.5,196.7813,798.5,192.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="800.5" y1="192.7813" y2="192.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="242.5" y="172.5825">Fetching information from the Settings page.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="242.5" y="187.7153">設定ページから情報を取得する</text><path d="M148,207.7813 L212,207.7813 L212,214.7813 L202,224.7813 L148,224.7813 L148,207.7813 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="352.9922" style="stroke:#000000;stroke-width:2.0;" width="1251.5" x="148" y="207.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="163" y="220.8481">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="38" x="227" y="219.9917">[loop]</text><polygon fill="#A80036" points="1003,257.1797,1013,261.1797,1003,265.1797,1007,261.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="1009" y1="261.1797" y2="261.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="428" x="242.5" y="240.981">Fetch the event date from the Datetime column of the latest page.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307" x="242.5" y="256.1138">最新ページのDatetimeカラムから開催日を取得する</text><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="277.5" y1="305.4453" y2="305.4453"/><line style="stroke:#A80036;stroke-width:1.0;" x1="277.5" x2="277.5" y1="305.4453" y2="318.4453"/><line style="stroke:#A80036;stroke-width:1.0;" x1="236.5" x2="277.5" y1="318.4453" y2="318.4453"/><polygon fill="#A80036" points="246.5,314.4453,236.5,318.4453,246.5,322.4453,242.5,318.4453" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="557" x="242.5" y="285.2466">Filter the creation targets from the settings page to only those for today and tomorrow.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="416" x="242.5" y="300.3794">設定ページから作成対象が今日・明日のものだけをフィルタリングする</text><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="277.5" y1="362.7109" y2="362.7109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="277.5" x2="277.5" y1="362.7109" y2="375.7109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="236.5" x2="277.5" y1="375.7109" y2="375.7109"/><polygon fill="#A80036" points="246.5,371.7109,236.5,375.7109,246.5,379.7109,242.5,375.7109" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="380" x="242.5" y="342.5122">Skip if the page has already been created before the event.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312" x="242.5" y="357.645">すでに開催前のページが作成されている場合スキップ</text><polygon fill="#A80036" points="1129.5,415.9766,1139.5,419.9766,1129.5,423.9766,1133.5,419.9766" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="1135.5" y1="419.9766" y2="419.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374" x="242.5" y="399.7778">Fetch properties and parent page IDs from template page.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325" x="242.5" y="414.9106">テンプレートページからプロパティ・親ページIDを取得</text><polygon fill="#A80036" points="1256,460.2422,1266,464.2422,1256,468.2422,1260,464.2422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="1262" y1="464.2422" y2="464.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333" x="242.5" y="444.0435">Create a new page based on the fetched properties.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260" x="242.5" y="459.1763">取得したプロパティを元に新規ページを作成</text><polygon fill="#A80036" points="794.5,504.5078,804.5,508.5078,794.5,512.5078,798.5,508.5078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="800.5" y1="508.5078" y2="508.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315" x="242.5" y="488.3091">Update previous_id with the ID of the latest page.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="242.5" y="503.4419">最新ページのIDでprevious_idを更新</text><polygon fill="#A80036" points="1350.5,548.7734,1360.5,552.7734,1350.5,556.7734,1354.5,552.7734" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="235.5" x2="1356.5" y1="552.7734" y2="552.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="242.5" y="532.5747">Notify that page creation is complete.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="242.5" y="547.7075">ページ作成完了通知</text><polygon fill="#A80036" points="40.5,600.0391,30.5,604.0391,40.5,608.0391,36.5,604.0391" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="34.5" x2="234.5" y1="604.0391" y2="604.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="46.5" y="583.8403">end of process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="46.5" y="598.9731">処理終了</text><!--MD5=[a04708aed09b9700e38786c3bbcf5d71]
@startuml
title Notion-page-repeater

participant cron
control "Notion-page-repeater" as s

database SettingPage as sp

database ParentPage as pp
participant "ParentPage->\nLatestPage" as lp
participant "ParentPage->\nTemplatePage" as tp
participant "ParentPage->\nNewPage" as np

participant Slack

cron->s: Run the script periodically. \n定期的にスクリプトを実行する
s->sp: Fetching information from the Settings page.\n設定ページから情報を取得する

alt loop
  s->lp: Fetch the event date from the Datetime column of the latest page.\n最新ページのDatetimeカラムから開催日を取得する
  s->s: Filter the creation targets from the settings page to only those for today and tomorrow.\n設定ページから作成対象が今日・明日のものだけをフィルタリングする
  s->s: Skip if the page has already been created before the event.\nすでに開催前のページが作成されている場合スキップ
  s->tp: Fetch properties and parent page IDs from template page.\nテンプレートページからプロパティ・親ページIDを取得
  s->np: Create a new page based on the fetched properties.\n取得したプロパティを元に新規ページを作成
  s->sp: Update previous_id with the ID of the latest page.\n最新ページのIDでprevious_idを更新
  s->Slack: Notify that page creation is complete.\nページ作成完了通知
end
s->cron:end of process\n処理終了
@enduml

PlantUML version 1.2021.13(Mon Nov 01 11:38:45 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>
